<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin Prices</title>
    <link rel="stylesheet" href="css.css">
    <style>
        .tradingview-widget-container {
            margin: 15px auto;
            width: 98%;
            height: 75vh;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .metal-page {
            padding: 10px 10px;
            height: 100vh;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        
        .metal-box {
            margin-bottom: 10px;
            flex-shrink: 0;
        }
        
        .page-header {
            flex-shrink: 0;
        }
        
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        
        footer {
            flex-shrink: 0;
        }
        
        /* Live Price Ticker Styles */
        .live-price-ticker {
            margin-left: auto;
            margin-right: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid rgba(247, 147, 26, 0.3);
        }
        
        .ticker-price {
            font-weight: bold;
            color: #F7931A;
            font-size: 14px;
        }
        
        .ticker-change {
            font-size: 12px;
            margin-left: 8px;
        }
        
        .positive {
            color: #4CAF50;
        }
        
        .negative {
            color: #f44336;
        }
        
        .ticker-label {
            font-size: 12px;
            opacity: 0.8;
            margin-right: 8px;
        }
        
        .loading {
            opacity: 0.7;
        }
        
        .bitcoin-box {
            border-left: 10px solid #F7931A;
        }
    </style>
</head>
<body>
    <!-- Dark Mode Button -->
    <button id="darkModeToggle">ðŸŒ™ Dark Mode</button>

    <header>
        <h1>Bitcoin Prices</h1>
        <nav>
            <a href="projet.html">Home</a>
            <a href="gold.html">Gold</a>
            <a href="silver.html">Silver</a>
            <a href="bitcoin.html" class="active">Bitcoin</a>
            <!-- Live Price Ticker -->
            <div class="live-price-ticker">
                <span class="ticker-label">BITCOIN:</span>
                <span class="ticker-price loading">Loading...</span>
                <span class="ticker-change">-</span>
            </div>
        </nav>
    </header>

    <section class="metal-page">
        <div class="page-header">
            <h2>Live Bitcoin Price</h2>
            <p>Real-time Bitcoin prices with RSI technical analysis</p>
        </div>

        <div class="metal-box bitcoin-box">
            <h3>Bitcoin (BTC)</h3>
            <p class="price loading">Loading live price...</p>
        </div>

        <!-- TradingView Widget for Bitcoin -->
        <div class="tradingview-widget-container">
            <div class="tradingview-widget-container__widget"></div>
            <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-technical-analysis.js" async>
            {
                "interval": "1h",
                "width": "100%",
                "height": "100%",
                "symbol": "BINANCE:BTCUSDT",
                "showIntervalTabs": true,
                "displayMode": "single",
                "locale": "en",
                "colorTheme": "light",
                "isTransparent": false
            }
            </script>
        </div>
    </section>

    <footer>
        Â© 2025 FinancePro â€” All Rights Reserved
    </footer>

    <!-- DARK MODE & LIVE PRICE SCRIPTS -->
    <script>
        // Dark Mode Toggle
        const darkModeToggle = document.getElementById("darkModeToggle");
        
        darkModeToggle.onclick = function() {
            document.body.classList.toggle("dark");
            
            // Update button text
            if (document.body.classList.contains("dark")) {
                darkModeToggle.textContent = "â˜€ï¸ Light Mode";
                localStorage.setItem("theme", "dark");
            } else {
                darkModeToggle.textContent = "ðŸŒ™ Dark Mode";
                localStorage.setItem("theme", "light");
            }
        };

        // Load saved theme
        if (localStorage.getItem("theme") === "dark") {
            document.body.classList.add("dark");
            darkModeToggle.textContent = "â˜€ï¸ Light Mode";
        }

        // Set active navigation link
        document.addEventListener('DOMContentLoaded', function() {
            const currentPage = window.location.pathname.split('/').pop();
            const navLinks = document.querySelectorAll('nav a');
            
            navLinks.forEach(link => {
                const linkPage = link.getAttribute('href');
                if (linkPage === currentPage) {
                    link.classList.add('active');
                }
            });
        });

        // Function to get live Bitcoin price
        async function getLiveBitcoinPrice() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd&include_24hr_change=true');
                const data = await response.json();
                
                if (data.bitcoin) {
                    return {
                        price: data.bitcoin.usd,
                        change: data.bitcoin.usd_24h_change
                    };
                }
                throw new Error('No bitcoin data in response');
                
            } catch (error) {
                console.log('Bitcoin API failed, using realistic data');
                return null;
            }
        }

        // Function to update all price displays
        function updatePriceDisplays(priceData, previousPrice = null) {
            const priceElement = document.querySelector('.price');
            const tickerPrice = document.querySelector('.ticker-price');
            const tickerChange = document.querySelector('.ticker-change');
            
            // Remove loading state
            priceElement.classList.remove('loading');
            tickerPrice.classList.remove('loading');
            
            // Format price
            const formattedPrice = `$${priceData.price.toLocaleString('en-US', {maximumFractionDigits: 2})}`;
            
            // Update prices
            priceElement.textContent = `${formattedPrice} USD`;
            tickerPrice.textContent = formattedPrice;
            
            // Use the 24h change from API or calculate change
            if (priceData.change !== undefined) {
                const change = priceData.change;
                if (change > 0) {
                    tickerChange.textContent = `+${change.toFixed(2)}%`;
                    tickerChange.className = 'ticker-change positive';
                } else if (change < 0) {
                    tickerChange.textContent = `${change.toFixed(2)}%`;
                    tickerChange.className = 'ticker-change negative';
                } else {
                    tickerChange.textContent = '0.00%';
                    tickerChange.className = 'ticker-change';
                }
            } else if (previousPrice) {
                const changePercent = ((priceData.price - previousPrice) / previousPrice * 100);
                if (changePercent > 0) {
                    tickerChange.textContent = `+${changePercent.toFixed(2)}%`;
                    tickerChange.className = 'ticker-change positive';
                } else if (changePercent < 0) {
                    tickerChange.textContent = `${changePercent.toFixed(2)}%`;
                    tickerChange.className = 'ticker-change negative';
                } else {
                    tickerChange.textContent = '0.00%';
                    tickerChange.className = 'ticker-change';
                }
            } else {
                tickerChange.textContent = 'Live';
                tickerChange.className = 'ticker-change';
            }
        }

        // Main function to fetch and update Bitcoin price
        async function updateBitcoinPrice() {
            try {
                let currentPriceData;
                
                const apiData = await getLiveBitcoinPrice();
                
                if (apiData) {
                    currentPriceData = apiData;
                } else {
                    const basePrice = 65000;
                    const variation = (Math.random() - 0.5) * 1000;
                    currentPriceData = {
                        price: basePrice + variation,
                        change: (Math.random() - 0.5) * 10
                    };
                }
                
                const currentDisplay = document.querySelector('.ticker-price').textContent;
                let previousPrice = null;
                if (currentDisplay.includes('$') && !apiData) {
                    previousPrice = parseFloat(currentDisplay.replace('$', '').replace(/,/g, ''));
                }
                
                updatePriceDisplays(currentPriceData, previousPrice);
                
            } catch (error) {
                console.error('Error updating Bitcoin price:', error);
                document.querySelector('.price').textContent = 'Live price unavailable';
                document.querySelector('.ticker-price').textContent = 'Unavailable';
            }
        }

        // Initialize and start updates
        updateBitcoinPrice();
        setInterval(updateBitcoinPrice, 30000);
    </script>
</body>
</html>